# Django Blog System with Traffic Control

本プロジェクトは、Djangoフレームワークを用いたブログアプリケーションに、ミドルウェア層でのトラフィック制御とセッションベースのアクセス管理を統合したプロトタイプです。

## 概要
標準的なブログ機能に加え、サーバーリソースの保護と認証状態に応じたユーザー誘導の仕組みを、フレームワークのミドルウェア層で実装しています。学習目的として、Djangoのリクエスト処理フローとMiddlewareの責務を理解することを主眼に設計しています。


## 技術スタック
- **Framework**: Django
- **Database**: SQLite3
- **Caching**: LocMemCache (Django Local-memory caching)
- **Language**: Python3

## 実装済みの主要機能

### 1. トークンバケット・アルゴリズムによる流量制限
`blog/utils/rate_limiter.py` において、ネットワークトラフィック制御で用いられるトークンバケット・アルゴリズムを実装しています。
- **バースト許容**: 瞬間的なアクセス集中を `capacity` パラメータ（10.0）で許容します。
- **補充モデル**: 前回アクセスからの経過時間（`delta_time`）に基づき、定義された `rate`（1.0/s）に従ってトークンを動的に補充します。
- **状態管理**: 判定用データは Django Cache（`LocMemCache`）に格納し、10分間の有効期限（TTL）を設定してメモリを管理します。
※ 本実装は単一プロセス環境を前提とした簡易実装であり、
分散環境での運用には外部ストア等が必要と認識しています。


### 2. セッションベースの動的アクセス制御
`blog/middleware/ratelimit_middleware.py` において、リクエストのライフサイクルに応じたパス制御を実施しています。
- **ゲスト閲覧状態の保持**: クエリパラメータ（`?guest=true`）の検知時、`request.session` を用いて閲覧許可状態をサーバーサイドで保持します。
- **自動リダイレクト**: 未認証かつ非ゲスト状態のユーザーを、案内用ページ（`gate_page`）へ強制的に誘導します。
- **管理者バイパス**: `is_staff` 属性を評価し、開発者による管理操作を制限対象から除外するロジックを組んでいます。

### 3. ブログ・コンテンツ管理
`views.py` および `models.py` に基づき、以下の機能を備えています。
- 記事の一覧表示および詳細表示。
- 認証ユーザーによる記事の新規作成・編集機能。
- 記事の削除機能。

## セットアップ
1. 依存パッケージのインストール
2. データベースマイグレーション
3. 開発用サーバーの起動
```bash
python manage.py migrate
python manage.py runserver
```
##  公開URL
http://kokiito0906.pythonanywhere.com/
※記事の追加・編集・削除にはログインが必要です。